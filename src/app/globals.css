@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Minstrel Dark Studio Aesthetic — single dark theme, no light mode */
    --background: 0 0% 5.9%;
    --foreground: 0 0% 100%;
    --card: 0 0% 9%;
    --card-foreground: 0 0% 100%;
    --popover: 0 0% 9%;
    --popover-foreground: 0 0% 100%;
    --primary: 206 70% 70%;
    --primary-foreground: 0 0% 5.9%;
    --secondary: 0 0% 12.2%;
    --secondary-foreground: 0 0% 100%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 50%;
    --accent: 0 0% 12.2%;
    --accent-foreground: 0 0% 100%;
    --destructive: 42 70% 70%;
    --destructive-foreground: 0 0% 10%;
    --border: 0 0% 16.5%;
    --input: 0 0% 20%;
    --ring: 206 70% 70%;

    /* Chart / data viz colors */
    --chart-1: 206 70% 70%;
    --chart-2: 257 36% 75%;
    --chart-3: 144 35% 75%;
    --chart-4: 42 70% 70%;
    --chart-5: 137 40% 65%;

    /* 0px border radius everywhere */
    --radius: 0rem;

    /* Typography scale */
    --font-size-metric-primary: 24px;
    --font-size-metric-secondary: 16px;
    --font-size-heading: 18px;
    --font-size-body: 14px;
    --font-size-label: 10px;

    /* Z-index scale — complete hierarchy, all layers documented
     * --z-base:     0  → Canvas overlays, chord strips, inline elements
     * --z-overlay: 10  → In-canvas UI (legends, HUDs, snapshot CTA, warm-up prompt)
     * --z-banner:  20  → Banners (return-session, error, MIDI loading)
     * --z-nav:     30  → StatusBar, fixed navigation, sidebar
     * --z-panel:   40  → Panels (troubleshooting), tooltips
     * --z-modal:   50  → Modals, alerts, dialogs, full-screen overlays
     * --z-toast:   60  → Toasts, achievement notifications
     * --z-critical:100  → Critical overlays (mobile redirect, migration blocking)
     */
    --z-base: 0;
    --z-overlay: 10;
    --z-banner: 20;
    --z-nav: 30;
    --z-panel: 40;
    --z-modal: 50;
    --z-toast: 60;
    --z-critical: 100;

    /* Minstrel extended palette */
    --surface: 0 0% 9%;
    --surface-light: 0 0% 12.2%;
    --surface-lighter: 0 0% 14.9%;
    --surface-border: 0 0% 20%;
    --text-primary: 0 0% 100%;
    --text-secondary: 0 0% 63.9%;
    --text-tertiary: 0 0% 50%;
    --accent-blue: 206 70% 70%;
    --accent-violet: 257 36% 75%;
    --accent-green: 144 35% 75%;
    --accent-warm: 42 70% 70%;
    --accent-success: 137 40% 65%;
    --accent-error: 42 60% 65%;

    /* Visualization RGB values — for Canvas 2D API and SVG rgba() usage */
    --viz-primary-rgb: 124, 185, 232;
    --viz-background-rgb: 15, 15, 15;
    --viz-warm-rgb: 232, 199, 123;
    --viz-harmonic-rgb: 180, 167, 214;
    --viz-timing-rgb: 168, 213, 186;
    --viz-muted-rgb: 102, 102, 102;
    --viz-white-rgb: 255, 255, 255;
    --viz-primary-dark: hsl(206 55% 59%);
    --viz-surface-dark: hsl(0 0% 16.5%);
    --viz-border-dark: hsl(0 0% 10%);
  }

  * {
    @apply border-border;
  }

  html {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings: 'cv02', 'cv03', 'cv04', 'cv11';
  }
}

/* Reduced motion support (AC 8, NFR23) */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Focus indicators (WCAG 2.1 AA) — applied to non-component elements.
   shadcn/ui components define their own ring-based focus styles. */
@layer base {
  :focus-visible:not([data-slot]) {
    @apply outline-2 outline-offset-2 outline-primary;
  }
}

/* Sidebar transition utility */
@layer utilities {
  .sidebar-transition {
    transition: width 200ms ease-in-out;
  }
}

/* Growth mindset color utilities — "Amber, Not Red" principle (UX9) */
@layer utilities {
  .text-progress {
    color: hsl(var(--accent-warm));
  }
  .text-achieved {
    color: hsl(var(--accent-blue));
  }
  .text-metric {
    font-family: 'JetBrains Mono', ui-monospace, monospace;
    color: hsl(var(--accent-blue));
  }
}

@layer utilities {
  @keyframes fadeUp {
    from {
      opacity: 0;
      transform: translate(-50%, 8px);
    }
    to {
      opacity: 1;
      transform: translate(-50%, 0);
    }
  }
  @keyframes shimmer {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(400%);
    }
  }
  @keyframes pulse-dot {
    0%,
    80%,
    100% {
      opacity: 0.3;
      transform: scale(0.8);
    }
    40% {
      opacity: 1;
      transform: scale(1.2);
    }
  }
  @keyframes pulse-glow {
    0%,
    100% {
      opacity: 0.2;
      transform: scale(1);
    }
    50% {
      opacity: 0.5;
      transform: scale(1.8);
    }
  }
  @keyframes pulse-border {
    0%,
    100% {
      opacity: 0;
    }
    50% {
      opacity: 0.4;
    }
  }
  @keyframes arrow-bounce {
    0%,
    100% {
      transform: translateY(0);
      opacity: 0.4;
    }
    50% {
      transform: translateY(6px);
      opacity: 0.8;
    }
  }
  @keyframes banner-slide-in {
    from {
      opacity: 0;
      transform: translate(-50%, -12px);
    }
    to {
      opacity: 1;
      transform: translate(-50%, 0);
    }
  }
  @keyframes modal-fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  @keyframes mode-fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
  @keyframes modal-scale-in {
    from {
      opacity: 0;
      transform: scale(0.96);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
}
